<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>SMAL &mdash; MRS 0.1 documentation</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    
<link rel="stylesheet" href="../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/bootswatch-amelia.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/font-awesome.min.css">
<!--[if IE 7]>
<link rel="stylesheet" href="../_static/css/font-awesome-ie7.min.css">
<![endif]-->
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
}
</style>
<link rel="stylesheet" href="../_static/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/bootstrap-responsive.min.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../',
            VERSION:     '0.1',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="../_static/js/jquery.min.js"></script>
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.show-sidebar').click(function(e) {
       e.preventDefault();
       if ($(".show-sidebar").html() == "Open Table Of Contents") {
          $('.for-mobile').removeClass('hidden-phone');
          $(".show-sidebar").html("Close Table Of Contents");
       } else {
          $(".show-sidebar").html("Open Table Of Contents");
       }
    });
  });
</script>
    <link rel="top" title="MRS 0.1 documentation" href="../index.html" />
    <link rel="up" title="API Reference" href="index.html" />
    <link rel="prev" title="Module: tests.test_analysis" href="MRS.tests.html" />
  <meta name="keywords" content="MRI, Stanford, Python, Neuroscience, MR
  spectroscopy, MRS">

  </head>
  <body>
<link href="https://www.stanford.edu/su-identity/css/su-identity.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700" rel="stylesheet" type="text/css">
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<!--[if IE 8]>
  <link rel="stylesheet" type="text/css" href="https://www.stanford.edu/su-identity/css/ie/ie8.css" />
<![endif]-->
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="https://www.stanford.edu/su-identity/css/ie/ie7.css" />
<![endif]-->

<!-- Brandbar snippet start -->
<div id="brandbar">
  <div class="container">
    <a href="http://cni.github.io/MRS/doc/_build/html/index.html">
    Stanford CNI MRS Library (SMAL)
    </a>
  </div> <!-- .container end -->
</div> <!-- #brandbar end -->
<!-- Brandbar snippet end -->



    <!-- container -->
    <div class="container-fluid">


      
      <div class="row-fluid hidden-desktop hidden-tablet">
      
<div class="span3 ">
  <a class="visible-phone btn btn-small show-sidebar" data-toggle="collapse" data-target=".for-mobile">Open Table Of Contents</a>
  <div class="for-mobile sidebar hidden-phone">
  
<h4> Stanford CNI </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://cni.stanford.edu/">Home Page</a></li>
    <li><a class="reference external"
	href="https://scitran.stanford.edu/">PoST</a></li>
    <li><a class="reference external"
	href="https://cni.stanford.edu/nims/">NIMS</a></li>
    <li><a class="reference external"
	href="http://cni.stanford.edu/wiki/Main_Page">Wiki</a></li>
  </ul>


  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">utils</span></tt></a><ul>
<li><a class="reference internal" href="#bi-square">bi_square</a></li>
<li><a class="reference internal" href="#detect-outliers">detect_outliers</a></li>
<li><a class="reference internal" href="#do-kernel">do_kernel</a></li>
<li><a class="reference internal" href="#epanechnikov">epanechnikov</a></li>
<li><a class="reference internal" href="#freq-to-ppm">freq_to_ppm</a></li>
<li><a class="reference internal" href="#gaussian">gaussian</a></li>
<li><a class="reference internal" href="#l2-norm">l2_norm</a></li>
<li><a class="reference internal" href="#line-broadening">line_broadening</a></li>
<li><a class="reference internal" href="#lorentzian">lorentzian</a></li>
<li><a class="reference internal" href="#lowess">lowess</a></li>
<li><a class="reference internal" href="#make-idx">make_idx</a></li>
<li><a class="reference internal" href="#ols-matrix">ols_matrix</a></li>
<li><a class="reference internal" href="#phase-correct-first">phase_correct_first</a></li>
<li><a class="reference internal" href="#phase-correct-zero">phase_correct_zero</a></li>
<li><a class="reference internal" href="#ppm-idx">ppm_idx</a></li>
<li><a class="reference internal" href="#ppm-to-freq">ppm_to_freq</a></li>
<li><a class="reference internal" href="#rmse">rmse</a></li>
<li><a class="reference internal" href="#tri-cube">tri_cube</a></li>
<li><a class="reference internal" href="#two-gaussian">two_gaussian</a></li>
<li><a class="reference internal" href="#two-lorentzian">two_lorentzian</a></li>
<li><a class="reference internal" href="#unit-vector">unit_vector</a></li>
<li><a class="reference internal" href="#zero-pad">zero_pad</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="MRS.tests.html"
                        title="previous chapter">Module: <tt class="docutils literal"><span class="pre">tests.test_analysis</span></tt></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/reference/MRS.utils.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  
<div id="searchbox-site" style="display: none">
  <h3>Search this site</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="13" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


  </div>
</div>
      </div>
      

      <!-- row -->
      <div class="row-fluid">
        
        

        <div class="span9">
          <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="module-MRS.utils">
<span id="utils"></span><h1><tt class="xref py py-mod docutils literal"><span class="pre">utils</span></tt><a class="headerlink" href="#module-MRS.utils" title="Permalink to this headline">¶</a></h1>
<p>Utility functions for analysis of MRS data.</p>
<div class="section" id="bi-square">
<h2>bi_square<a class="headerlink" href="#bi-square" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.bi_square">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">bi_square</tt><big>(</big><em>xx</em>, <em>idx=None</em><big>)</big><a class="headerlink" href="#MRS.utils.bi_square" title="Permalink to this definition">¶</a></dt>
<dd><p>The bi-square weight function calculated over values of xx</p>
<p>xx: float array</p>
<p>This is the first equation on page 831 of [Cleveland79].</p>
</dd></dl>

</div>
<div class="section" id="detect-outliers">
<h2>detect_outliers<a class="headerlink" href="#detect-outliers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.detect_outliers">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">detect_outliers</tt><big>(</big><em>in_arr</em>, <em>thresh=3.0</em><big>)</big><a class="headerlink" href="#MRS.utils.detect_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects outliers more than X standard deviations from mean.</p>
<dl class="docutils">
<dt>in_list: ndarray</dt>
<dd>An array of measures for which outliers need to be detected.</dd>
<dt>thresh: float (optional)</dt>
<dd>Threshold number of standard deviations before a measure is considered
an outlier. Default = 3.0</dd>
</dl>
<dl class="docutils">
<dt>outlier_idx: ndarray of boolean  </dt>
<dd>An array indicating if a measure is an outlier (True) or not (False).</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="do-kernel">
<h2>do_kernel<a class="headerlink" href="#do-kernel" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.do_kernel">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">do_kernel</tt><big>(</big><em>x0</em>, <em>x</em>, <em>l=1.0</em>, <em>kernel=&lt;function epanechnikov at 0x10d8f68c0&gt;</em><big>)</big><a class="headerlink" href="#MRS.utils.do_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a kernel function on x in the neighborhood of x0</p>
<dl class="docutils">
<dt>x: float array</dt>
<dd>All values of x</dd>
<dt>x0: float</dt>
<dd>The value of x around which we evaluate the kernel</dd>
<dt>l: float or float array (with shape = x.shape)</dt>
<dd>Width parameter (metric window size)</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="epanechnikov">
<h2>epanechnikov<a class="headerlink" href="#epanechnikov" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.epanechnikov">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">epanechnikov</tt><big>(</big><em>xx</em>, <em>idx=None</em><big>)</big><a class="headerlink" href="#MRS.utils.epanechnikov" title="Permalink to this definition">¶</a></dt>
<dd><p>The Epanechnikov kernel estimated for xx values at indices idx (zero
elsewhere)</p>
<dl class="docutils">
<dt>xx: float array</dt>
<dd>Values of the function on which the kernel is computed. Typically,
these are Euclidean distances from some point x0 (see do_kernel)</dd>
<dt>idx: tuple</dt>
<dd>An indexing tuple pointing to the coordinates in xx for which the
kernel value is estimated. Default: None (all points are used!)</dd>
</dl>
<p>This is equation 6.4 in FHT chapter 6</p>
</dd></dl>

</div>
<div class="section" id="freq-to-ppm">
<h2>freq_to_ppm<a class="headerlink" href="#freq-to-ppm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.freq_to_ppm">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">freq_to_ppm</tt><big>(</big><em>f</em>, <em>water_hz=0.0</em>, <em>water_ppm=4.7</em>, <em>hz_per_ppm=127.68</em><big>)</big><a class="headerlink" href="#MRS.utils.freq_to_ppm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a set of numbers from frequenxy in hertz to chemical shift in ppm</p>
</dd></dl>

</div>
<div class="section" id="gaussian">
<h2>gaussian<a class="headerlink" href="#gaussian" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.gaussian">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">gaussian</tt><big>(</big><em>freq</em>, <em>freq0</em>, <em>sigma</em>, <em>amp</em>, <em>offset</em>, <em>drift</em><big>)</big><a class="headerlink" href="#MRS.utils.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>A Gaussian function with flexible offset, drift and amplitude</p>
</dd></dl>

</div>
<div class="section" id="l2-norm">
<h2>l2_norm<a class="headerlink" href="#l2-norm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.l2_norm">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">l2_norm</tt><big>(</big><em>arr</em><big>)</big><a class="headerlink" href="#MRS.utils.l2_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>The l2 norm of an array is is defined as: sqrt(||x||), where ||x|| is the
dot product of the vector.</p>
</dd></dl>

</div>
<div class="section" id="line-broadening">
<h2>line_broadening<a class="headerlink" href="#line-broadening" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.line_broadening">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">line_broadening</tt><big>(</big><em>ts</em>, <em>width</em><big>)</big><a class="headerlink" href="#MRS.utils.line_broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply line-broadening to a time-series</p>
<p>ts : a nitime.TimeSeries class instance</p>
<dl class="docutils">
<dt>width <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The exponential decay time-constant (in seconds)</dd>
</dl>
<p>A nitime.TimeSeries class instance with windowed data</p>
<p>For details, see page 92 of <a class="reference internal" href="#keeler2005">Keeler2005</a>.</p>
<table class="docutils citation" frame="void" id="keeler2005" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Keeler2005]</td><td>Keeler, J (2005). Understanding NMR spectroscopy, second
edition. Wiley (West Sussex, UK).</td></tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="lorentzian">
<h2>lorentzian<a class="headerlink" href="#lorentzian" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.lorentzian">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">lorentzian</tt><big>(</big><em>freq</em>, <em>freq0</em>, <em>area</em>, <em>hwhm</em>, <em>phase</em>, <em>offset</em>, <em>drift</em><big>)</big><a class="headerlink" href="#MRS.utils.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Lorentzian line-shape function</p>
<dl class="docutils">
<dt>freq <span class="classifier-delimiter">:</span> <span class="classifier">float or float array</span></dt>
<dd>The frequencies for which the function is evaluated</dd>
<dt>freq0 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The center frequency of the function</dd>
</dl>
<p>area : float</p>
<dl class="docutils">
<dt>hwhm: float</dt>
<dd>Half-width at half-max</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lowess">
<h2>lowess<a class="headerlink" href="#lowess" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.lowess">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">lowess</tt><big>(</big><em>x</em>, <em>w</em>, <em>x0</em>, <em>kernel=&lt;function epanechnikov at 0x10d8f68c0&gt;</em>, <em>l=1</em>, <em>robust=False</em><big>)</big><a class="headerlink" href="#MRS.utils.lowess" title="Permalink to this definition">¶</a></dt>
<dd><p>Locally linear regression with the LOWESS algorithm.</p>
<dl class="docutils">
<dt>x: float n-d array  </dt>
<dd>Values of x for which f(x) is known (e.g. measured). The shape of this
is (n, j), where n is the number the dimensions of the and j is the
number of distinct coordinates sampled.</dd>
<dt>w: float array</dt>
<dd>The known values of f(x) at these points. This has shape (j,)</dd>
<dt>x0: float or float array.</dt>
<dd>Values of x for which we estimate the value of f(x). This is either a
single scalar value (only possible for the 1d case, in which case f(x0)
is estimated for just that one value of x), or an array of shape (n, k).</dd>
<dt>kernel: callable</dt>
<dd>A kernel function. {&#8216;epanechnikov&#8217;, &#8216;tri_cube&#8217;}</dd>
<dt>l: float or float array with shape = x.shape</dt>
<dd>The metric window size for the kernel</dd>
<dt>robust: bool</dt>
<dd>Whether to apply the robustification procedure from [Cleveland79], page
831</dd>
</dl>
<p>The function estimated at x0.</p>
<p>The solution to this problem is given by equation 6.8 in Friedman, Hastie
and Tibshirani (2008). The Elements of Statistical Learning (Chapter 6).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">lowess</span> <span class="kn">as</span> <span class="nn">lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p># For the 1D case:
&gt;&gt;&gt; x = np.random.randn(100)
&gt;&gt;&gt; f = np.cos(x) + 0.2 * np.random.randn(100)
&gt;&gt;&gt; x0 = np.linspace(-1,1,10)
&gt;&gt;&gt; f_hat = lo.lowess(x, f, x0)
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig,ax = plt.subplots(1)
&gt;&gt;&gt; ax.scatter(x,f)
&gt;&gt;&gt; ax.plot(x0,f_hat,&#8217;ro&#8217;)
&gt;&gt;&gt; plt.show()</p>
<p># 2D case (and more...)
&gt;&gt;&gt; x = np.random.randn(2, 100)
&gt;&gt;&gt; f = -1 * np.sin(x[0]) + 0.5 * np.cos(x[1]) + 0.2*np.random.randn(100)
&gt;&gt;&gt; x0 = np.mgrid[-1:1:.1, -1:1:.1]
&gt;&gt;&gt; x0 = np.vstack([x0[0].ravel(), x0[1].ravel()])
&gt;&gt;&gt; f_hat = lo.lowess(x, f, x0, kernel=lo.tri_cube)
&gt;&gt;&gt; from mpl_toolkits.mplot3d import Axes3D
&gt;&gt;&gt; fig = plt.figure()
&gt;&gt;&gt; ax = fig.add_subplot(111, projection=&#8216;3d&#8217;)
&gt;&gt;&gt; ax.scatter(x[0], x[1], f)
&gt;&gt;&gt; ax.scatter(x0[0], x0[1], f_hat, color=&#8217;r&#8217;)</p>
</dd></dl>

</div>
<div class="section" id="make-idx">
<h2>make_idx<a class="headerlink" href="#make-idx" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.make_idx">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">make_idx</tt><big>(</big><em>f</em>, <em>lb</em>, <em>ub</em><big>)</big><a class="headerlink" href="#MRS.utils.make_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a little utility function to replace an oft-called set of
operations</p>
<dl class="docutils">
<dt>f <span class="classifier-delimiter">:</span> <span class="classifier">1d array</span></dt>
<dd>A frequency axis along which we want to slice</dd>
<dt>lb <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Defines the upper bound of slicing</dd>
<dt>ub <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Defines the lower bound of slicing</dd>
</dl>
<p>idx : a slice object</p>
</dd></dl>

</div>
<div class="section" id="ols-matrix">
<h2>ols_matrix<a class="headerlink" href="#ols-matrix" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.ols_matrix">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">ols_matrix</tt><big>(</big><em>A</em>, <em>norm_func=None</em><big>)</big><a class="headerlink" href="#MRS.utils.ols_matrix" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Generate the matrix used to solve OLS regression.</p>
<dl class="docutils">
<dt>A: float array</dt>
<dd>The design matrix</dd>
<dt>norm: callable, optional</dt>
<dd>A normalization function to apply to the matrix, before extracting the
OLS matrix.</dd>
</dl>
<p>The matrix needed for OLS regression for the equation:</p>
<p>..math</p>
<div class="highlight-python"><div class="highlight"><pre>y = A eta
</pre></div>
</div>
</div></blockquote>
<p>is given by:</p>
<blockquote>
<div><p>..math</p>
<div class="highlight-python"><div class="highlight"><pre>\hat{eta} = (A&#39; x A)^{-1} A&#39; y
</pre></div>
</div>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Ordinary_least_squares#Estimation">http://en.wikipedia.org/wiki/Ordinary_least_squares#Estimation</a></p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="phase-correct-first">
<h2>phase_correct_first<a class="headerlink" href="#phase-correct-first" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.phase_correct_first">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">phase_correct_first</tt><big>(</big><em>spec</em>, <em>freq</em>, <em>k</em><big>)</big><a class="headerlink" href="#MRS.utils.phase_correct_first" title="Permalink to this definition">¶</a></dt>
<dd><p>First order phase correction.</p>
<dl class="docutils">
<dt>spec <span class="classifier-delimiter">:</span> <span class="classifier">float array</span></dt>
<dd>The spectrum to be corrected.</dd>
<dt>freq <span class="classifier-delimiter">:</span> <span class="classifier">float array</span></dt>
<dd>The frequency axis.</dd>
<dt>k <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The slope of the phase correction as a function of frequency.</dd>
</dl>
<p>The phase-corrected spectrum.</p>
<dl class="docutils">
<dt>[Keeler2005] Keeler, J (2005). Understanding NMR Spectroscopy, 2nd</dt>
<dd>edition. Wiley. Page 88</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="phase-correct-zero">
<h2>phase_correct_zero<a class="headerlink" href="#phase-correct-zero" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.phase_correct_zero">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">phase_correct_zero</tt><big>(</big><em>spec</em>, <em>phi</em><big>)</big><a class="headerlink" href="#MRS.utils.phase_correct_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the phases of a spectrum by phi radians</p>
<dl class="docutils">
<dt>spec <span class="classifier-delimiter">:</span> <span class="classifier">float array of complex dtype</span></dt>
<dd>The spectrum to be corrected.</dd>
</dl>
<p>phi : float</p>
<dl class="docutils">
<dt>spec <span class="classifier-delimiter">:</span> <span class="classifier">float array</span></dt>
<dd>The phase corrected spectrum</dd>
</dl>
<dl class="docutils">
<dt>[Keeler2005] Keeler, J (2005). Understanding NMR Spectroscopy, 2nd</dt>
<dd>edition. Wiley. Page 88.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="ppm-idx">
<h2>ppm_idx<a class="headerlink" href="#ppm-idx" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.ppm_idx">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">ppm_idx</tt><big>(</big><em>f_ppm</em>, <em>lb</em>, <em>ub</em><big>)</big><a class="headerlink" href="#MRS.utils.ppm_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a slice object according to the ppm scale</p>
<dl class="docutils">
<dt>f_ppm <span class="classifier-delimiter">:</span> <span class="classifier">float array</span></dt>
<dd>The frequency bins (in the ppm scale). Assumed to be descending</dd>
<dt>lb,ub <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The lower/upper bounds for indexing</dd>
</dl>
<p>idx : slice object which can be used to index</p>
</dd></dl>

</div>
<div class="section" id="ppm-to-freq">
<h2>ppm_to_freq<a class="headerlink" href="#ppm-to-freq" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.ppm_to_freq">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">ppm_to_freq</tt><big>(</big><em>ppm</em>, <em>water_hz=0.0</em>, <em>water_ppm=4.7</em>, <em>hz_per_ppm=127.68</em><big>)</big><a class="headerlink" href="#MRS.utils.ppm_to_freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an array from chemical shift to Hz</p>
</dd></dl>

</div>
<div class="section" id="rmse">
<h2>rmse<a class="headerlink" href="#rmse" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.rmse">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">rmse</tt><big>(</big><em>arr1</em>, <em>arr2</em><big>)</big><a class="headerlink" href="#MRS.utils.rmse" title="Permalink to this definition">¶</a></dt>
<dd><p>The root of the mean of the squared error between arr1 and arr2</p>
<dl class="docutils">
<dt>arr1, arr2 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>The two arrays to compare</dd>
</dl>
<p>RMSE : float</p>
<p>The RMSE will be summarized in one number. That is, even if the two arrays
are multi-dimensional, the error between them will be averaged over the
entire array and then the sqrt will be derived.</p>
</dd></dl>

</div>
<div class="section" id="tri-cube">
<h2>tri_cube<a class="headerlink" href="#tri-cube" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.tri_cube">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">tri_cube</tt><big>(</big><em>xx</em>, <em>idx</em><big>)</big><a class="headerlink" href="#MRS.utils.tri_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>The tri-cube kernel estimated for xx values at indices idx (zero
elsewhere)</p>
<dl class="docutils">
<dt>xx: float array</dt>
<dd>Values of the function on which the kernel is computed. Typically,
these are Euclidean distances from some point x0 (see do_kernel)</dd>
<dt>idx: tuple</dt>
<dd>An indexing tuple pointing to the coordinates in xx for which the
kernel value is estimated. Default: None (all points are used!)</dd>
</dl>
<p>This is equation 6.6 in FHT chapter 6</p>
</dd></dl>

</div>
<div class="section" id="two-gaussian">
<h2>two_gaussian<a class="headerlink" href="#two-gaussian" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.two_gaussian">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">two_gaussian</tt><big>(</big><em>freq</em>, <em>freq0_1</em>, <em>freq0_2</em>, <em>sigma1</em>, <em>sigma2</em>, <em>amp1</em>, <em>amp2</em>, <em>offset</em>, <em>drift</em><big>)</big><a class="headerlink" href="#MRS.utils.two_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>A two-Gaussian model.</p>
<p>This is simply the sum of two gaussian functions in some part of the
spectrum. Each individual gaussian has its own peak frequency, sigma,
and amp, but they share common offset and drift parameters.</p>
</dd></dl>

</div>
<div class="section" id="two-lorentzian">
<h2>two_lorentzian<a class="headerlink" href="#two-lorentzian" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.two_lorentzian">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">two_lorentzian</tt><big>(</big><em>freq</em>, <em>freq0_1</em>, <em>freq0_2</em>, <em>area1</em>, <em>area2</em>, <em>hwhm1</em>, <em>hwhm2</em>, <em>phase1</em>, <em>phase2</em>, <em>offset</em>, <em>drift</em><big>)</big><a class="headerlink" href="#MRS.utils.two_lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>A two-Lorentzian model.</p>
<p>This is simply the sum of two lorentzian functions in some part of the
spectrum. Each individual Lorentzian has its own peak frequency, area, hwhm
and phase, but they share common offset and drift parameters.</p>
</dd></dl>

</div>
<div class="section" id="unit-vector">
<h2>unit_vector<a class="headerlink" href="#unit-vector" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.unit_vector">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">unit_vector</tt><big>(</big><em>arr</em>, <em>norm_func=&lt;function l2_norm at 0x10d8f6b90&gt;</em><big>)</big><a class="headerlink" href="#MRS.utils.unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the array by a norm function (defaults to the l2_norm)</p>
<p>arr: ndarray</p>
<dl class="docutils">
<dt>norm_func: callable</dt>
<dd>A function that is used here to normalize the array.</dd>
</dl>
<p>The norm_func is the thing that defines what a unit vector is for the
particular application.</p>
</dd></dl>

</div>
<div class="section" id="zero-pad">
<h2>zero_pad<a class="headerlink" href="#zero-pad" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MRS.utils.zero_pad">
<tt class="descclassname">MRS.utils.</tt><tt class="descname">zero_pad</tt><big>(</big><em>ts</em>, <em>n_zeros</em><big>)</big><a class="headerlink" href="#MRS.utils.zero_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad a nitime.TimeSeries class instance with n_zeros before and after the
data</p>
<p>ts : a nitime.TimeSeries class instance</p>
</dd></dl>

</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
         
<div class="span3 visible-desktop visible-tablet">
  <div class=" sidebar hidden-phone">
  
<h4> Stanford CNI </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://cni.stanford.edu/">Home Page</a></li>
    <li><a class="reference external"
	href="https://scitran.stanford.edu/">PoST</a></li>
    <li><a class="reference external"
	href="https://cni.stanford.edu/nims/">NIMS</a></li>
    <li><a class="reference external"
	href="http://cni.stanford.edu/wiki/Main_Page">Wiki</a></li>
  </ul>


  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">utils</span></tt></a><ul>
<li><a class="reference internal" href="#bi-square">bi_square</a></li>
<li><a class="reference internal" href="#detect-outliers">detect_outliers</a></li>
<li><a class="reference internal" href="#do-kernel">do_kernel</a></li>
<li><a class="reference internal" href="#epanechnikov">epanechnikov</a></li>
<li><a class="reference internal" href="#freq-to-ppm">freq_to_ppm</a></li>
<li><a class="reference internal" href="#gaussian">gaussian</a></li>
<li><a class="reference internal" href="#l2-norm">l2_norm</a></li>
<li><a class="reference internal" href="#line-broadening">line_broadening</a></li>
<li><a class="reference internal" href="#lorentzian">lorentzian</a></li>
<li><a class="reference internal" href="#lowess">lowess</a></li>
<li><a class="reference internal" href="#make-idx">make_idx</a></li>
<li><a class="reference internal" href="#ols-matrix">ols_matrix</a></li>
<li><a class="reference internal" href="#phase-correct-first">phase_correct_first</a></li>
<li><a class="reference internal" href="#phase-correct-zero">phase_correct_zero</a></li>
<li><a class="reference internal" href="#ppm-idx">ppm_idx</a></li>
<li><a class="reference internal" href="#ppm-to-freq">ppm_to_freq</a></li>
<li><a class="reference internal" href="#rmse">rmse</a></li>
<li><a class="reference internal" href="#tri-cube">tri_cube</a></li>
<li><a class="reference internal" href="#two-gaussian">two_gaussian</a></li>
<li><a class="reference internal" href="#two-lorentzian">two_lorentzian</a></li>
<li><a class="reference internal" href="#unit-vector">unit_vector</a></li>
<li><a class="reference internal" href="#zero-pad">zero_pad</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="MRS.tests.html"
                        title="previous chapter">Module: <tt class="docutils literal"><span class="pre">tests.test_analysis</span></tt></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/reference/MRS.utils.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  
<div id="searchbox-site" style="display: none">
  <h3>Search this site</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="13" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


  </div>
</div> 
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row-fluid">
<div class="related navbar navbar-inverse">
  <div class="navbar-inner">
    <ul class="nav pull-right">
      
        <li><a href="../genindex.html" title="General Index" accesskey="I">index</a></li>
        <li><a href="../py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="MRS.tests.html" title="Module: tests.test_analysis" accesskey="P">previous</a></li>
        <li><a href="../index.html">MRS 0.1 documentation</a></li>
        <li><a href="index.html" accesskey="U">API Reference</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->

      <footer>
          &copy; Copyright 2014, Ariel Rokem, Grace Tang, Stanford CNI.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
      </footer>

  </div> <!-- #su-content end -->
</div> <!-- #su-wrap end -->

<!-- Global footer snippet start -->
<div id="global-footer">
  <div class="container">
    <div class="row">
      <div id="bottom-logo" class="span2">
        <a href="http://www.stanford.edu">
          <img src="https://www.stanford.edu/su-identity/images/footer-stanford-logo@2x.png" alt="Stanford University" width="105" height="49"/>
        </a>
      </div>
      <!-- #bottom-logo end -->
      <div id="bottom-text" class="span10">
        <ul>
          <li class="home"><a href="http://www.stanford.edu">SU Home</a></li>
          <li class="maps alt"><a href="http://visit.stanford.edu/plan/maps.html">Maps &amp; Directions</a></li>
          <li class="search-stanford"><a href="http://www.stanford.edu/search/">Search Stanford</a></li>
          <li class="terms alt"><a href="http://www.stanford.edu/site/terms.html">Terms of Use</a></li>
          <li class="emergency-info"><a href="http://emergency.stanford.edu">Emergency Info</a></li>
        </ul>
      </div> <!-- .bottom-text end -->
      <div class="clear"></div>
      <br><p class="copyright vcard">&copy; <span class="fn org">Stanford University</span>, <span class="adr"> <span class="locality">Stanford</span>, <span class="region">California</span> <span class="postal-code">94305</span></span>.&nbsp;&nbsp;
      <span id="copyright-complaint"><a href="http://www.stanford.edu/group/security/dmca.html" class="copyright-complaint" >Copyright Complaints</a></span>
      </p>
    </div> <!-- .row end --> 
  </div> <!-- .container end --> 
</div> <!-- global-footer end -->
<!-- Global footer snippet end -->

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-54034205-1");
pageTracker._trackPageview();
} catch(err) {}</script>

      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>